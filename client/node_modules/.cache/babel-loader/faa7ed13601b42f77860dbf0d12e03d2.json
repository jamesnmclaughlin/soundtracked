{"ast":null,"code":"var _jsxFileName = \"/Users/jamesmclaughlin/Sites/soundtracked/client/src/components/service.js\";\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport getServiceID from './functions/functions';\nvar crypto = require('crypto');\nvar base64url = require('base64url');\nexport default function Service(props) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"service\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 10,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"service-img \" + props.api,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 11,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"service-type \" + props.type,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"service-connect\",\n    href: connectURL(props.api),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 13\n    }\n  }, \"Connect \", generateCodeVerifier()));\n}\nfunction connectURL(apiService) {\n  var url = \"\";\n  var response_type = \"code\";\n  var scope = \"\";\n  var approval_prompt = \"force\";\n  var redirectURL = \"http://localhost:3000/\" + apiService;\n  var code_challenge = \"\";\n  var apiIdentifier = getServiceID(apiService);\n  switch (apiService) {\n    case \"strava\":\n      scope = \"read,activity:read\";\n      url = \"https://www.strava.com/oauth/authorize?\";\n      url = url + \"client_id=\" + apiIdentifier + \"&response_type=\" + response_type + \"&redirect_uri=\" + redirectURL + \"&approval_prompt=\" + approval_prompt + \"&scope=\" + scope;\n      break;\n    case \"fitbit\":\n      code_challenge = \"test\";\n      scope = \"activity,heartrate\";\n      url = \"https://www.fitbit.com/oauth2/authorize?\";\n      url = url + \"client_id=\" + apiIdentifier + \"&code_challenge=\" + code_challenge + \"&code_challege_method=S256&response_type=\" + response_type;\n      break;\n    case \"lastfm\":\n      url = \"http://www.last.fm/api/auth?\";\n      url = url + \"api_key=\" + apiIdentifier + \"&cb=\" + redirectURL;\n      break;\n    case \"deezer\":\n      url = \"https://connect.deezer.com/oauth/auth.php?\";\n      url = url + \"app_id=\" + apiIdentifier + \"&redirect_uri=\" + redirectURL + \"&perms=basic_access,listening_history\";\n      break;\n  }\n  return url;\n}\nfunction generateCodeVerifier() {\n  // Clearing previous code verifier\n  localStorage.removeItem('fitbitCV');\n  var code = crypto.randomBytes(128).toString('base64url');\n  return code;\n}","map":{"version":3,"names":["React","Link","getServiceID","crypto","require","base64url","Service","props","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","api","type","href","connectURL","generateCodeVerifier","apiService","url","response_type","scope","approval_prompt","redirectURL","code_challenge","apiIdentifier","localStorage","removeItem","code","randomBytes","toString"],"sources":["/Users/jamesmclaughlin/Sites/soundtracked/client/src/components/service.js"],"sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport getServiceID from './functions/functions';\n\nconst crypto = require('crypto');\nconst base64url = require('base64url');\n\nexport default function Service(props) {\n    return (\n        <div className=\"service\">\n            <div className={\"service-img \" + props.api}></div>\n            <div className={\"service-type \" + props.type}></div>\n            <a className=\"service-connect\" href={connectURL(props.api)}>Connect { generateCodeVerifier() }</a>\n        </div>\n    );\n}\n\nfunction connectURL(apiService) {\n    let url = \"\";\n    let response_type = \"code\";\n    let scope = \"\";\n    let approval_prompt = \"force\";\n    let redirectURL = \"http://localhost:3000/\" + apiService;\n    let code_challenge = \"\"\n    let apiIdentifier = getServiceID(apiService);\n\n    switch(apiService) {\n        case \"strava\":\n            \n            scope = \"read,activity:read\";\n            url = \"https://www.strava.com/oauth/authorize?\";\n            url = url + \"client_id=\" + apiIdentifier + \"&response_type=\" + response_type + \"&redirect_uri=\" + redirectURL + \"&approval_prompt=\" + approval_prompt + \"&scope=\" + scope;\n            break;\n        case \"fitbit\": \n            \n            code_challenge = \"test\"\n\n            scope = \"activity,heartrate\";\n            url = \"https://www.fitbit.com/oauth2/authorize?\";\n            url = url + \"client_id=\" + apiIdentifier + \"&code_challenge=\" + code_challenge + \"&code_challege_method=S256&response_type=\" + response_type;\n            break;\n        case \"lastfm\":\n            url = \"http://www.last.fm/api/auth?\";\n            url = url + \"api_key=\" + apiIdentifier + \"&cb=\" + redirectURL;\n            break;\n        case \"deezer\": \n            url = \"https://connect.deezer.com/oauth/auth.php?\";\n            url = url + \"app_id=\" + apiIdentifier + \"&redirect_uri=\" + redirectURL + \"&perms=basic_access,listening_history\"\n            break;\n    }\n\n    return url;\n}\n\nfunction generateCodeVerifier() {\n    // Clearing previous code verifier\n    localStorage.removeItem('fitbitCV');\n\n    const code = crypto.randomBytes(128).toString('base64url');\n\n    return code\n}"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,IAAI,QAAQ,kBAAkB;AACvC,OAAOC,YAAY,MAAM,uBAAuB;AAEhD,IAAMC,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAChC,IAAMC,SAAS,GAAGD,OAAO,CAAC,WAAW,CAAC;AAEtC,eAAe,SAASE,OAAOA,CAACC,KAAK,EAAE;EACnC,oBACIP,KAAA,CAAAQ,aAAA;IAAKC,SAAS,EAAC,SAAS;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACpBf,KAAA,CAAAQ,aAAA;IAAKC,SAAS,EAAE,cAAc,GAAGF,KAAK,CAACS,GAAI;IAAAN,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,EAAO,eAClDf,KAAA,CAAAQ,aAAA;IAAKC,SAAS,EAAE,eAAe,GAAGF,KAAK,CAACU,IAAK;IAAAP,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,EAAO,eACpDf,KAAA,CAAAQ,aAAA;IAAGC,SAAS,EAAC,iBAAiB;IAACS,IAAI,EAAEC,UAAU,CAACZ,KAAK,CAACS,GAAG,CAAE;IAAAN,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAC,UAAQ,EAAEK,oBAAoB,EAAE,CAAM,CAChG;AAEd;AAEA,SAASD,UAAUA,CAACE,UAAU,EAAE;EAC5B,IAAIC,GAAG,GAAG,EAAE;EACZ,IAAIC,aAAa,GAAG,MAAM;EAC1B,IAAIC,KAAK,GAAG,EAAE;EACd,IAAIC,eAAe,GAAG,OAAO;EAC7B,IAAIC,WAAW,GAAG,wBAAwB,GAAGL,UAAU;EACvD,IAAIM,cAAc,GAAG,EAAE;EACvB,IAAIC,aAAa,GAAG1B,YAAY,CAACmB,UAAU,CAAC;EAE5C,QAAOA,UAAU;IACb,KAAK,QAAQ;MAETG,KAAK,GAAG,oBAAoB;MAC5BF,GAAG,GAAG,yCAAyC;MAC/CA,GAAG,GAAGA,GAAG,GAAG,YAAY,GAAGM,aAAa,GAAG,iBAAiB,GAAGL,aAAa,GAAG,gBAAgB,GAAGG,WAAW,GAAG,mBAAmB,GAAGD,eAAe,GAAG,SAAS,GAAGD,KAAK;MACzK;IACJ,KAAK,QAAQ;MAETG,cAAc,GAAG,MAAM;MAEvBH,KAAK,GAAG,oBAAoB;MAC5BF,GAAG,GAAG,0CAA0C;MAChDA,GAAG,GAAGA,GAAG,GAAG,YAAY,GAAGM,aAAa,GAAG,kBAAkB,GAAGD,cAAc,GAAG,2CAA2C,GAAGJ,aAAa;MAC5I;IACJ,KAAK,QAAQ;MACTD,GAAG,GAAG,8BAA8B;MACpCA,GAAG,GAAGA,GAAG,GAAG,UAAU,GAAGM,aAAa,GAAG,MAAM,GAAGF,WAAW;MAC7D;IACJ,KAAK,QAAQ;MACTJ,GAAG,GAAG,4CAA4C;MAClDA,GAAG,GAAGA,GAAG,GAAG,SAAS,GAAGM,aAAa,GAAG,gBAAgB,GAAGF,WAAW,GAAG,uCAAuC;MAChH;EAAM;EAGd,OAAOJ,GAAG;AACd;AAEA,SAASF,oBAAoBA,CAAA,EAAG;EAC5B;EACAS,YAAY,CAACC,UAAU,CAAC,UAAU,CAAC;EAEnC,IAAMC,IAAI,GAAG5B,MAAM,CAAC6B,WAAW,CAAC,GAAG,CAAC,CAACC,QAAQ,CAAC,WAAW,CAAC;EAE1D,OAAOF,IAAI;AACf"},"metadata":{},"sourceType":"module"}